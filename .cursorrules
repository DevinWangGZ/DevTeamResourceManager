# DevTeam Manager 项目开发规则

## 项目概述
开发人员管理工具（DevTeam Manager）是一个极简、透明、自助的内部开发者资源管理与协作平台。

## 核心设计原则（必须严格遵守）

### 1. 极简主义
- **功能以解决核心痛点为准，非必要不添加**
- 每个功能必须对应明确的业务需求
- 避免过度设计，优先实现 MVP
- UI/UX 保持简洁，减少认知负担

### 2. 去审批化
- **不设复杂审批流**
- 以"公开透明"和"事后确认"保障数据质量
- 任务确认采用"点击确认"而非审批流程
- 默认信任用户填报，通过同伴监督纠偏

### 3. 用户友好
- **注重开发人员填报体验**
- 通过引导和趣味化设计降低抵触情绪
- 减少必填项，提供合理的默认值
- 操作流程尽可能简短，减少点击次数

### 4. 数据驱动
- **所有分析、报告均基于"投入人天"等客观数据**
- 避免主观评价，使用量化指标
- 数据可视化优先于文字描述
- 统计口径统一，确保数据可比性

### 5. 信任为先
- **默认信任用户填报**
- 通过同伴监督和事后核对纠偏
- 不设置复杂的权限控制
- 数据修改记录可追溯

## 核心业务实体与状态

### 人员档案
- **技能**：自维护列表，格式 `{技能名, 熟练度:熟悉/熟练/精通}`，无需审核
- **业务履历**：自登记参与的项目模块，格式 `{项目, 模块, 角色, 贡献描述, 投入人天}`
- **状态标签**：趣味化情绪标签（如🚀"火力全开"），可选
- **序列管理**：自维护序列等级和单价，格式 `{序列等级, 单价(元/人天)}`，如：初级开发1500、中级开发2000、高级开发2500

### 任务系统（核心）
- **生命周期状态流**：`草稿 -> 已发布 -> 已认领 -> 进行中 -> 已提交 -> 已确认 -> 已归档`
- **关键字段**：
  - `拟投入人天`：发布时由PM填写
  - `实际投入人天`：提交时由开发者填写
  - `确认状态`：PM点击确认，非审批
- **数据流**：任务`已确认`后，其"实际投入人天"自动汇入开发者工作量统计

### 团队资源视图
- **负荷计算**：基于已认领任务的"拟投入人天"和时间分布
- **可视状态**：红（过载）/黄（适中）/绿（空闲）

## 用户角色

### 开发人员
- 维护个人档案、认领任务、记录工作、查看个人数据
- 核心页面：个人工作台、任务集市、负荷管理、技能档案、业务履历、我的绩效

### 项目经理/组长
- 发布任务、确认工作量、组建团队、查看团队数据
- 管理项目产值、查看任务执行视图
- 核心页面：管理仪表盘、人员信息中心、任务发布与管理、负荷可视化、团队能力洞察、绩效数据管理、项目产值管理、任务执行视图

### 系统管理员
- 管理用户、配置基础数据、系统维护
- 核心页面：系统管理

## 技术规范

### 代码质量
- 代码模块化，关键业务逻辑必须有注释
- 遵循单一职责原则，函数/类职责清晰
- 核心状态流可插拔，便于后续扩展（如增加审批流）

### 性能要求
- 列表页加载时间 < 2秒
- 关键操作响应 < 1秒
- 优化数据库查询，避免 N+1 问题
- 合理使用缓存策略

### 安全性
- 接口权限校验必须实现
- 数据隔离：用户只能访问授权范围内的数据
- 防XSS注入：所有用户输入必须转义/验证
- 敏感操作记录操作日志

### 可维护性
- 代码结构清晰，目录组织合理
- 关键业务逻辑有详细注释
- 使用统一的错误处理机制
- 日志记录关键操作和异常

### 可扩展性
- 核心状态流设计为可插拔架构
- 预留扩展点，便于后续增加审批流等功能
- 使用配置化方式管理业务规则
- 避免硬编码，使用常量/配置管理

## 开发约定

### 命名规范
- 使用有意义的变量名和函数名
- 遵循项目技术栈的命名约定
- 状态字段使用枚举或常量定义

### 数据模型
- 任务状态使用枚举类型，避免字符串硬编码
- 人天数据统一使用浮点数或整数（根据精度需求）
- 时间字段统一使用时间戳或标准时间格式

### API 设计
- RESTful 风格，语义清晰
- 统一的响应格式
- 错误码规范统一
- 接口文档及时更新

### 前端技术栈与规范

**详细规范请参考**：`docs/FRONTEND_RULES.md`

**核心技术栈**：
- Vue 3.4+ (组合式API, `<script setup>`)
- TypeScript 5.3+
- Vite 5.0+
- Element Plus 2.4+
- Pinia 2.1+ (状态管理)
- Vue Router 4.2+ (路由)
- Axios 1.6+ (HTTP客户端)
- ECharts 5.4+ (数据可视化)

**关键规范**：
- 组件使用`<script setup>`语法，Props/Emits使用TypeScript类型定义
- 状态管理使用Pinia，按模块划分store
- API层统一使用Axios拦截器，按模块划分API文件
- 样式使用`<style scoped>` + Element Plus主题变量
- 路由组件使用动态import实现懒加载

### 后端技术栈与规范

**详细规范请参考**：`docs/BACKEND_RULES.md`

**核心技术栈**：
- Python 3.12
- FastAPI 0.104+ (异步Web框架)
- SQLAlchemy 2.0+ (ORM)
- Alembic 1.13+ (数据库迁移)
- PostgreSQL 15+ (生产数据库)
- Pydantic 2.5+ (数据验证)

**关键规范**：
- API端点使用FastAPI Router，按模块划分
- 使用依赖注入管理数据库会话和用户认证
- 业务逻辑集中在service层，不直接在端点中处理
- 使用Pydantic模式进行请求/响应验证
- 数据库模型使用SQLAlchemy ORM，状态字段使用枚举
- 使用Alembic进行数据库迁移管理

## 功能优先级

### P0（核心功能，必须实现）
1. 用户认证与角色管理
2. 任务系统（发布、认领、提交、确认）
3. 人员档案管理（技能、履历）
4. 工作量统计（基于实际投入人天）

### P1（重要功能，优先实现）
1. 负荷可视化（个人/团队）
2. 任务集市（浏览、筛选、认领）
3. 管理仪表盘（团队指标、待办提醒）
4. 绩效数据可视化

### P2（增强功能，后续迭代）
1. 智能匹配（基于需求的候选人推荐）
2. 团队能力洞察（技能矩阵、人才梯队分析）
3. 数据导出功能
4. 消息通知系统

## 注意事项

1. **避免过度设计**：先实现核心功能，再考虑扩展
2. **保持数据一致性**：任务确认后的人天数据必须准确汇入统计
3. **用户体验优先**：减少操作步骤，提供快捷入口
4. **数据透明**：关键数据对所有相关人员可见
5. **向后兼容**：数据结构变更时考虑数据迁移方案
